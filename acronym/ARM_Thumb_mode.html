<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="ARM Thumb mode">
    <meta name="author" content="Geraldo Luis da Silva Ribeiro">
    <title>ARM Thumb mode</title>
    <script async src="https://ackee.intmain.io/tracker.js" data-ackee-server="https://ackee.intmain.io" data-ackee-domain-id="ae2b54a4-84be-4e13-9143-062488243a8c"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/base16/materia.min.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js"></script>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6442897272752686" crossorigin="anonymous"></script>
    <!-- thumbnail_image not define-->
    <link rel="stylesheet" href="/styles.css">
  </head>
  <body class="bg-black">
    <nav class="bg-slate-800 text-blue-400 border-gray-200 px-2 sm:px-4 py-2.5">
      <div class="container flex flex-wrap justify-between items-center mx-auto"><a class="flex items-center" href="/"><img class="mr-3 h-6 sm:h-9" src="/logo.svg" alt="Geraldo Ribeiro"><span class="self-center text-xl font-semibold whitespace-nowrap underline-offset-8 hover:underline hover:text-white">Geraldo Ribeiro </span></a>
        <ul class="hidden fixed top-0 right-0 px-10 py-16 bg-gray-800 z-30 md:relative md:flex md:p-0 md:bg-transparent md:flex-row md:space-x-6" id="menu">
          <li class="z-40 fixed top-4 right-6 md:hidden" id="menu-close-btn"><a class="text-right text-blue-500 text-4xl font-bold" href="javascript:void(0)">&times;</a></li>
          <li><a class="block py-2 pr-4 pl-3 text-blue-400 underline-offset-8 hover:text-white hover:underline md:p-0" href="/about.html" aria-current="page">About</a></li>
          <li><a class="block py-2 pr-4 pl-3 text-blue-400 underline-offset-8 hover:text-white hover:underline md:p-0" href="/tils.html" aria-current="page">Today I Learned</a></li>
          <li><a class="block py-2 pr-4 pl-3 text-blue-400 underline-offset-8 hover:text-white hover:underline md:p-0" href="/certificates.html" aria-current="page">Certificates</a></li>
        </ul>
        <div class="flex mr-2 items-center md:hidden" id="menu-hamburger-btn"><a class="text-slate-500 text-2xl font-bold opacity-70 duration-300 hover:opacity-100" href="javascript:void(0)">&#x2630; </a></div>
      </div>
    </nav>
    <script>
      window.addEventListener("load", () => {
        const menuHamburgerBtn = document.querySelector("#menu-hamburger-btn");
        const menuCloseBtn = document.querySelector("#menu-close-btn");
        const menu = document.querySelector("#menu");
        menuHamburgerBtn.addEventListener("click", () => { menu.classList.toggle("hidden"); });
        menuCloseBtn.addEventListener("click", () => { menu.classList.toggle("hidden"); });
      });
    </script>
    <div class="prose mx-auto py-4 px-4">
      <form id="search" method="get" action="/search.html">
        <label class="mb-2 text-sm font-medium text-gray-300 sr-only" for="search-input">Search</label>
        <div class="relative">
          <div class="flex absolute inset-y-0 left-0 items-center pl-3 pointer-events-none">
            <svg class="w-5 h-5 text-gray-500 dark:text-gray-400" aria-hidden="true" fill="none" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
            </svg>
          </div>
          <input class="block p-4 pl-10 w-full text-sm text-white bg-slate-800 border border-slate-700 placeholder-slate-400 focus:ring-blue-500" id="search-input" type="search" name="query" placeholder="Search vim, bash..." required="">
          <button class="text-white absolute bg-slate-700 font-medium text-sm px-4 py-2 right-2.5 bottom-2.5 hover:bg-blue-800 focus:bg-blue-700 focus:outline-none focus:ring-blue-200" type="submit">Search</button>
        </div>
      </form>
    </div>
    <div class="bg-black text-slate-100 min-h-screen">
      <main class="bg-slate-900 max-w-prose mx-auto prose prose-invert text-slate-400 p-4 overflow-hidden"><a class="mb-2 text-slate-600 block cursor-pointer hover:text-slate-200" href="/acronyms.html">
          <svg class="inline h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M11 17l-5-5m0 0l5-5m-5 5h12"></path>
          </svg><span>Back to Acronyms</span></a>
        <h1>ARM Thumb mode</h1>
        <div class="text-slate-600">Date: <b class="mr-4 ml-2">2024-01-08</b>Last modified: <b class="ml-2">2024-11-11 </b></div>
        <div class="flex flex-wrap">
        </div><p>The ARM processor has 2 instruction sets, the traditional ARM set, where the instructions are all 32-bit long, and the more condensed Thumb set, where most common instructions are 16-bit long (and some are 32-bit long).
Which instruction set to run can be chosen by the developer, and only one set can be active (i.e. once the processor is switched to Thumb mode, all instructions will be decoded as using the Thumb instead of ARM).</p>
<p>Although they are different instruction sets, they share similar functionality, and can be represented using the same assembly language.</p>
<p>For example, the instruction
{{{code: lang=â€œcâ€ linenumbers=â€œTrueâ€
ADDS  R0, R1, R2
}}}
can be compiled to</p>
<ul>
<li>ARM (â€˜â€˜E0910002 / 11100000 10010001 00000000 00000010â€™â€™)</li>
<li>Thumb (â€˜â€˜1888 / 00011000 10001000â€™â€™).</li>
</ul>
<p>Thumb instructions are a subset of the ARM instruction set, encoded in 16 bits instead of 32 bits. They can perform most of the common operations, such as arithmetic, logical, data movement, branch, and load/store. However, they have some limitations, such as fewer registers, reduced addressing modes, and no conditional execution. Thumb instructions can only access the lower 8 registers (R0-R7) and the program counter (PC), link register (LR), and status register (CPSR). To access the upper 8 registers (R8-R15), you need to use special instructions or switch to ARM mode.</p>
<p>In assembly language, you can use the â€˜â€™.thumbâ€™â€™ and â€˜â€™.armâ€™â€™ directives to indicate the mode of the following instructions.</p>
<p>For example, you can write:
{{{code: lang=â€œasmâ€ linenumbers=â€œTrueâ€
.arm
MOV R0, #0x1000
BX R0 ; branch to Thumb mode at 0x1000
.thumb
ADD R0, R0, #1 ; Thumb instruction
MOV R1, PC
BIC R1, R1, #1 ; clear LSB of PC
BX R1 ; branch back to ARM mode
You can also use the .thumb_func directive to mark the start of a Thumb function, which will automatically set the LSB of the function address. For example, you can write:
.thumb_func
func:
PUSH {R4-R7, LR} ; save registers
; do some work
POP {R4-R7, PC} ; restore registers and return
}}}</p>
<p>In C language, you can use the <mark>â€˜â€˜attributeâ€™â€™</mark>â€˜â€™((thumb))â€˜â€™ and <mark>â€˜â€˜attributeâ€™â€™</mark>â€˜â€™((arm))â€˜â€™ keywords to specify the mode of a function.</p>
<p>For example, you can write:</p>
<p>{{{code: lang=â€œcâ€ linenumbers=â€œTrueâ€
attribute((thumb)) void thumb_func(void) {
// do some work in Thumb mode
}
attribute((arm)) void arm_func(void) {
// do some work in ARM mode
}
}}}</p>
<p>You can also use the <mark>â€˜â€˜asmâ€™â€™</mark> keyword to insert assembly code in your C program.
For example, you can write:</p>
<p>{{{code: lang=â€œcâ€ linenumbers=â€œTrueâ€
asm(â€œBX R0â€); // branch to the mode indicated by R0
}}}</p>
<p>Thumb instruction set encoding is a useful feature of the ARM architecture that can help you optimize your code for size, speed, and power.
By understanding how to switch between ARM and Thumb modes in assembly and C languages, you can take advantage of both modes and interwork seamlessly.</p>
<p><a href="https://www.youtube.com/watch?v=XbVONAOYKTw">https://www.youtube.com/watch?v=XbVONAOYKTw</a></p>
<figure>
  <img class="mx-auto" src="/acronym/F54E867DAFBF104A.webp" alt="">
  <figcaption class="text-center">
     <strong>Fig. 1</strong> - <span></span>
  </figcaption>
</figure>
<p>ğŸ“½ï¸ <a href="https://www.youtube.com/watch?v=Usjax7H0xuA">https://www.youtube.com/watch?v=Usjax7H0xuA</a> Modes of ARM7</p>
<h2 id="references" tabindex="-1">References</h2>
<ul>
<li><a href="https://www.linkedin.com/advice/1/how-do-you-switch-between-arm-thumb-modes-assembly">How do you switch between ARM and Thumb modes in assembly and C languages?</a></li>
<li><a href="https://stackoverflow.com/questions/10638130/what-is-the-arm-thumb-instruction-set">What is the ARM Thumb Instruction set?</a></li>
</ul>

      </main>
    </div>
    <footer class="bg-slate-500 text-slate-400 text-center pb-16">
      <div class="py-4 bg-slate-800">&copy; Geraldo Ribeiro 2024</div>
      <div class="max-w-prose mx-auto py-4 grid gap-y-8 grid-cols-3 justify-items-center md:grid-cols-5 lg:grid-cols-12"><a class="mx-2" href="mailto:geraldolsribeiro@gmail.com" target="_blank"><img class="h-12 w-12" title="E-mail" alt="E-mail" src="/social-email.svg"></a><a class="mx-2" href="https://www.linkedin.com/in/geraldolsribeiro/" target="_blank"><img class="h-12 w-12" title="Linkedin" alt="Linkedin" src="/social-linkedin.svg"></a><a class="mx-2" href="https://github.com/geraldolsribeiro" target="_blank"><img class="h-12 w-12" title="Github" alt="Github" src="/social-github.svg"></a><a class="mx-2" href="https://codepen.io/geraldolsribeiro/" target="_blank"><img class="h-12 w-12" title="Codepen" alt="Codepen" src="/social-codepen.svg"></a><a class="mx-2" href="https://twitter.com/geraldo_dev" target="_blank"><img class="h-12 w-12" title="Twitter" alt="Twitter" src="/social-twitter.svg"></a><a class="mx-2" href="https://t.me/geraldolsribeiro" target="_blank"><img class="h-12 w-12" title="Telegram" alt="Telegram" src="/social-telegram.svg"></a><a class="mx-2" href="https://api.whatsapp.com/send?phone=5512982302703&amp;text=Hi%20Geraldo!" target="_blank"><img class="h-12 w-12" title="Whatsapp" alt="Whatsapp" src="/social-whatsapp.svg"></a><a class="mx-2" href="https://www.instagram.com/geraldo.dev/" target="_blank"><img class="h-12 w-12" title="Instagram" alt="Instagram" src="/social-instagram.svg"></a><a class="mx-2" href="https://www.facebook.com/geraldolsribeiro" target="_blank"><img class="h-12 w-12" title="Facebook" alt="Facebook" src="/social-facebook.svg"></a><a class="mx-2" href="https://stackoverflow.com/users/554111/geraldo-luis-da-silva-ribeiro" target="_blank"><img class="h-12 w-12" title="StackOverflow" alt="StackOverflow" src="/social-stackoverflow.svg"></a><a class="mx-2" href="https://www.youtube.com/@dev.geraldo" target="_blank"><img class="h-12 w-12" title="Youtube" alt="Youtube" src="/social-youtube.svg"></a>
      </div>
    </footer>
    <script>
      //- hljs.highlightAll();
      //- https://github.com/wcoder/highlightjs-line-numbers.js
      //- Exemplo de numeracao em corba.md
      document.addEventListener('DOMContentLoaded', (event) => {
        document.querySelectorAll('pre code').forEach((el) => {
          hljs.highlightElement(el);
        });
      
        document.querySelectorAll('pre code[show-line-numbers]').forEach((el) => {
          hljs.lineNumbersBlock(el); // numbering using plugin
        });
      
      });
    </script>
    <script src="https://utteranc.es/client.js" repo="geraldolsribeiro/geraldo.dev" issue-term="pathname" theme="github-dark" crossorigin="anonymous" async></script>
  </body>
</html>