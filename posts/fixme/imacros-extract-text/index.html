<!DOCTYPE html>
<html lang="pt-br">

<head>

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0" />
<base href="https://geraldo.dev/">
<title>imacros - Extrair textos | geraldo.dev</title>
<link rel="canonical" href="https://geraldo.dev/posts/fixme/imacros-extract-text/">
<meta name="generator" content="Hugo 0.62.0" />


    <meta property="og:type" content="article" />
    <meta property="article:published_time" content="20/12/2018">



    <meta property="og:image" content="https://geraldo.dev/img/open_graph_02_1200x1200.jpg" />

    <meta property="og:description" content="Tecnologia, c&#43;&#43;, web, linux, git, desenvolvimento de software, dicas, tutoriais e notícias sobre o mundo opensource" />
    <meta property="og:url" content="https://geraldo.dev/posts/fixme/imacros-extract-text/" />
    <meta property="og:site_name" content="geraldo.dev" />
    <meta property="og:title" content="imacros - Extrair textos" />





    <meta name="description" content="Tecnologia, c&#43;&#43;, web, linux, git, desenvolvimento de software, dicas, tutoriais e notícias sobre o mundo opensource">
    
<meta name="author" content="Geraldo Ribeiro">

<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-139336679-1', 'auto');
	
	ga('send', 'pageview');
}
</script>



<link rel="stylesheet" async href="https://fonts.googleapis.com/icon?family=Material+Icons">
<link rel="stylesheet" async href="https://cdn.materialdesignicons.com/2.8.94/css/materialdesignicons.min.css">



<link rel="stylesheet"
      href="https://geraldo.dev/style.main.min.9e3ce174be768153dcf516f5eac5a7697a43da9708d5b1290103e0a7195c5a5c.css"
      integrity="sha256-njzhdL52gVPc9Rb16sWnaXpD2pcI1bEpAQPgpxlcWlw="
      media="screen" async>





</head>

<body>
    
        <header>
            <nav class="light-blue lighten-1" role="navigation">
    <div class="nav-wrapper container">
        <a id="logo-container" href="https://geraldo.dev/" class="brand-logo">geraldo.dev</a>


        <a href="#" data-target="mobile-demo" class="sidenav-trigger"><i class="material-icons">menu</i></a>
        <ul class="right hide-on-med-and-down">
            
<li><a href="/">Home</a></li>

<li><a href="/posts">Posts</a></li>

<li><a href="/publications">Artigos</a></li>

<li><a href="/projects">Projetos</a></li>


        </ul>
    </div>
</nav>

<ul class="sidenav" id="mobile-demo">
  
<li><a href="/">Home</a></li>

<li><a href="/posts">Posts</a></li>

<li><a href="/publications">Artigos</a></li>

<li><a href="/projects">Projetos</a></li>


</ul>


        </header>
    

    

    <main>
      <div class="page container">

        

        <div class="row">
          <div class="col s12 m6 center-align grey-text">
            Publicado em: 20/Dec/2018
          </div>
          
          <div class="col s12 m6 center-align grey-text">
            Atualizado em: 08/Jan/2020
          </div>
          
        </div>

        
        
        


        <h1>imacros - Extrair textos</h1>

        
<aside class="table-of-contents">
  <header>
    <h3>Sumário</h3>
  </header>
  <ul>
    <li><a href="https://geraldo.dev/posts/fixme/imacros-extract-text/#extract">EXTRACT</a>
      <ul>
        <li><a href="https://geraldo.dev/posts/fixme/imacros-extract-text/#txt">TXT</a></li>
        <li><a href="https://geraldo.dev/posts/fixme/imacros-extract-text/#txtall">TXTALL</a></li>
        <li><a href="https://geraldo.dev/posts/fixme/imacros-extract-text/#htm">HTM</a></li>
        <li><a href="https://geraldo.dev/posts/fixme/imacros-extract-text/#href">HREF</a></li>
        <li><a href="https://geraldo.dev/posts/fixme/imacros-extract-text/#alt">ALT</a></li>
        <li><a href="https://geraldo.dev/posts/fixme/imacros-extract-text/#title">TITLE</a></li>
        <li><a href="https://geraldo.dev/posts/fixme/imacros-extract-text/#checked">CHECKED</a></li>
        <li><a href="https://geraldo.dev/posts/fixme/imacros-extract-text/#extract-custom-attributes">Extract Custom Attributes</a></li>
      </ul>
    </li>
  </ul>

</aside>




        <div class="gr-main-content">
        <pre><code class="language-imacros" data-lang="imacros">TAG POS=n TYPE=type [FORM=form] ATTR=attr [CONTENT=some_content]
TAG XPATH=&quot;[xpath_expression]&quot; [CONTENT=some_content]
TAG SELECTOR=&quot;[selector_expression]&quot; [CONTENT=some_content]
</code></pre><pre><code class="language-imacros" data-lang="imacros">VERSION BUILD=10.4.28.1074
<p>TAB T=1
TAB CLOSEALLOTHERS
URL GOTO=http://demo.imacros.net/Automate/Extract2
TAG POS=1 TYPE=TD ATTR=CLASS:bdytxt&amp;&amp;TXT:* EXTRACT=TXT
TAG POS=1 TYPE=A ATTR=TXT:H*links* EXTRACT=TITLE
TAG POS=1 TYPE=SPAN ATTR=CLASS:bdytxt&amp;&amp;TXT:* EXTRACT=HTM<br>
TAG POS=1 TYPE=A ATTR=TXT:HREF&lt;SP&gt;extracts&lt;SP&gt;links EXTRACT=HREF<br>
TAG POS=1 TYPE=IMG ATTR=SRC:*shark_thumbnail.jpg EXTRACT=ALT      <br>
TAG POS=1 TYPE=INPUT:TEXT FORM=NAME:form1 ATTR=NAME:abc EXTRACT=TXT
TAG POS=1 TYPE=INPUT:TEXT FORM=NAME:form1 ATTR=ID:TF2 EXTRACT=TXT
TAG POS=2 TYPE=TABLE ATTR=TXT:*My* EXTRACT=TXT<br>
TAG POS=1 TYPE=TD ATTR=CLASS:bdytxt&amp;&amp;TXT:* EXTRACT=TXT
'
&lsquo;Relative extraction
'
&lsquo;1. Mark reference (anchor) element
TAG POS=1 TYPE=TH ATTR=TXT:MyTable
&lsquo;2. POS value is RELATIVE to the anchor element<br>
TAG POS=R3 TYPE=TD ATTR=TXT:* EXTRACT=TXT
&lsquo;The extracted values will be stored in the csv file under the iMacros Download folder
SAVEAS TYPE=EXTRACT FOLDER=* FILE=+_{{!NOW:yyyymmdd_hhnnss}}
</code></pre><h2 id="extract">EXTRACT</h2></p>
<p>Extracts data from websites. Use the attribute ATTR to determine which part is
to be extracted. Normally this part is generated by the Extraction Wizard. The
EXTRACT command searches the HTML source code of the website for the nth
occurrence of ATTR and extracts it. The ATTR must always end with a wildcard *.</p>
<p>If several EXTRACT commands appear in one macro the results are separated by
the string [EXTRACT]. This string is automatically translated into a line break
when using the &ldquo;SAVEAS TYPE=EXTRACT&rdquo; command.</p>
<p>If a complete table was extracted then adjacent table cells are separated by
the string #NEXT# and table rows are delimited by the string #NEWLINE#. These
tags are automatically translated into commas and newlines when you use the
&ldquo;SAVEAS TYPE=EXTRACT&rdquo; command, but the delimiters are retained when returning
the data to a script via a call to iimGetLastExtract. If the table you are
attempting to extract also contains nested tables, then the inner table data
will also be delimited with #NEXT# and #NEWLINE# (to make the data easier to
work with, only extract the innermost table that you need).</p>
<p>The following values may be specified in the EXTRACT parameter of a TAG command.</p>
<h3 id="txt">TXT</h3>
<p>Plain text extraction, all HTML tags are taken out.
When used with a drop-down list (select element), it extracts the selected (visible) entry.</p>
<h3 id="txtall">TXTALL</h3>
<p>For use with a drop-down list (select element). It extracts all entries of the list.</p>
<h3 id="htm">HTM</h3>
<p>The full HTML of the element the extraction anchor points to. Note: In the
iMacros Browser and IE the HTML tags are always returned in caps. So
<b>test</b> is extracted as <B>test</B>.</p>
<h3 id="href">HREF</h3>
<p>The URL of the page element the extraction anchor points to.</p>
<h3 id="alt">ALT</h3>
<p>The alternative text of an image the extraction anchor points to.</p>
<h3 id="title">TITLE</h3>
<p>The title attribute of an element, e.g. the tooltip text.</p>
<h3 id="checked">CHECKED</h3>
<p>Status of a checkbox or radiobutton. It returns &ldquo;true&rdquo; when the box is checked,
otherwise &ldquo;false&rdquo; (Related forum post: [1])</p>
<p>Note: When extracting text from input boxes (TAG command contains
&ldquo;TYPE=INPUT&rdquo;), there must not be a &ldquo;CONTENT&rdquo; parameter. Cf. the FAQ: How do
I extract the content of an Input Box?</p>
<h3 id="extract-custom-attributes">Extract Custom Attributes</h3>
<p>Starting with iMacros 10.2, you can extract any attribute. If you want to know
which attributes are available, record the TAG command in Expert Mode.</p>
<p>Example:</p>
<p>Normally, the tooltips are specified by the TITLE attribute of an element. You can extract the tooltip content with iMacros:</p>
<pre><code>TAG POS=3 TYPE=TD ATTR=TXT:* EXTRACT=TITLE
</code></pre>
<p>The qTip tooltip plugin for the jQuery JavaScript framework uses not the title attribute but a custom attribute named &ldquo;data-qtip&rdquo;:</p>
<pre><code>TAG POS=1 TYPE=TD ATTR=data-qtip:ComputerName=* EXTRACT=data-qtip
</code></pre>
<p>ComputerName=* is the initial immutable part of the tooltip content and is used
to specify which tooltip should be extracted. Recording in Expert Mode will
create a TAG command that consists of all attributes of the clicked HTML
element.</p>

        </div>

        

<div class="share-box center-align" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="facebook"
        href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fgeraldo.dev%2fposts%2ffixme%2fimacros-extract-text%2f"
        aria-label="share on Facebook"
        target="_blank" rel="noopener">
        <span class="mdi mdi-48px mdi-facebook"></span>
      </a>
    </li>

    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?url=https%3a%2f%2fgeraldo.dev%2fposts%2ffixme%2fimacros-extract-text%2f&amp;text=imacros%20-%20Extrair%20textos"
         target="_blank" rel="noopener">
        <span class="mdi mdi-48px mdi-twitter"></span>
      </a>
    </li>

    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fgeraldo.dev%2fposts%2ffixme%2fimacros-extract-text%2f&amp;title=imacros%20-%20Extrair%20textos"
         target="_blank" rel="noopener">
        <span class="mdi mdi-48px mdi-linkedin"></span>
      </a>
    </li>

    <li>
      <a class="email"
         href="mailto:?subject=imacros%20-%20Extrair%20textos&amp;body=https%3a%2f%2fgeraldo.dev%2fposts%2ffixme%2fimacros-extract-text%2f">
        <span class="mdi mdi-48px mdi-email"></span>
      </a>
    </li>

  </ul>
  <span>Compartilhe!</span>
</div>




        <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "geraldo-dev" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        <script>
var disqus_config = function () {
  this.language = "pt";
};
</script>

      </div>

    </main>


    
        <footer class="page-footer orange">
  <div class="container">
    <div class="row">
      <div class="col l9 s12">
        <h5 class="white-text">Você tem uma grande ideia?</h5>
        <p class="grey-text text-lighten-4">
          <ul>
            
          </ul>
        </p>

        <p class="grey-text text-lighten-4">
          Vamos marcar um café, talvez a solução seja muito mais simples do que você imagina.
        </p>
      </div>
      <div class="col l3 s12">
        <h5 class="white-text">Contatos</h5>
        <ul>
        
          <li>
            <a class="white-text" href="https://geraldo.dev">
              <span class="mdi mdi-24px mdi-web"></span>
              https://geraldo.dev
            </a>
          </li>
        
          <li>
            <a class="white-text" href="mailto:geraldolsribeiro@gmail.com">
              <span class="mdi mdi-24px mdi-email"></span>
              geraldo@intmain.io
            </a>
          </li>
        
          <li>
            <a class="white-text" href="https://api.whatsapp.com/send?phone=5512982302703&amp;text=Ol%c3%a1%20Geraldo!">
              <span class="mdi mdi-24px mdi-whatsapp"></span>
              (12) 9 8230 2703
            </a>
          </li>
        
          <li>
            <a class="white-text" href="https://twitter.com/geraldo_dev">
              <span class="mdi mdi-24px mdi-twitter"></span>
              geraldo_dev
            </a>
          </li>
        
          <li>
            <a class="white-text" href="https://www.instagram.com/geraldo.dev/">
              <span class="mdi mdi-24px mdi-instagram"></span>
              geraldo.dev
            </a>
          </li>
        
          <li>
            <a class="white-text" href="https://www.linkedin.com/in/geraldolsribeiro/">
              <span class="mdi mdi-24px mdi-linkedin"></span>
              geraldolsribeiro
            </a>
          </li>
        
          <li>
            <a class="white-text" href="https://www.facebook.com/geraldolsribeiro">
              <span class="mdi mdi-24px mdi-facebook"></span>
              geraldolsribeiro
            </a>
          </li>
        
          <li>
            <a class="white-text" href="https://github.com/geraldolsribeiro">
              <span class="mdi mdi-24px mdi-github-circle"></span>
              geraldolsribeiro
            </a>
          </li>
        
          <li>
            <a class="white-text" href="https://t.me/geraldolsribeiro">
              <span class="mdi mdi-24px mdi-telegram"></span>
              geraldolsribeiro
            </a>
          </li>
        
          <li>
            <a class="white-text" href="#ZgotmplZ">
              <span class="mdi mdi-24px mdi-skype"></span>
              geraldolsribeiro
            </a>
          </li>
        
          <li>
            <a class="white-text" href="https://codepen.io/geraldolsribeiro/">
              <span class="mdi mdi-24px mdi-codepen"></span>
              geraldolsribeiro
            </a>
          </li>
        
          <li>
            <a class="white-text" href="https://stackoverflow.com/users/554111/geraldo-luis-da-silva-ribeiro">
              <span class="mdi mdi-24px mdi-stack-overflow"></span>
              Stack overflow
            </a>
          </li>
        
          <li>
            <a class="white-text" href="https://scholar.google.com.br/citations?user=qsuG5ZkAAAAJ">
              <span class="mdi mdi-24px mdi-school"></span>
              Google Scholar
            </a>
          </li>
        
        </ul>
      </div>
    </div>
  </div>

    <div class="fixed-action-btn">
      <a class="btn-floating btn-large waves-effect waves-light ">
        <i class="large material-icons">chat</i>
      </a>
      <ul>
        
        
          <li>
              <a class="btn-floating waves-effect waves-light green darken-4"
                title="Chame pelo whatsapp!"
                target="_blank"
                href="https://api.whatsapp.com/send?phone=5512982302703&amp;text=Ol%c3%a1,%20Geraldo!">
              <span class="mdi mdi-24px mdi-whatsapp"></span>
            </a>
          </li>
        
      </ul>
    </div>


  <div class="footer-copyright">
    <div class="container">
      Feito com <i class="material-icons yellow-text" style="vertical-align: middle;">favorite</i> por Geraldo Ribeiro
    </div>
  </div>
</footer>

    

    
        






<script type="text/javascript" src="https://geraldo.dev/app.min.59882aba5a267177ea44b8e23767eb6092ffbd0fba04434f754edcc58be60ec5.js" integrity="sha256-WYgqulomcXfqRLjiN2frYJL/vQ&#43;6BENPdU7cxYvmDsU=" media="screen"></script>


    
</body>
</html>
