<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="C++ GAlib">
    <meta name="author" content="Geraldo Luis da Silva Ribeiro">
    <title>C++ GAlib</title>
    <script async src="https://ackee.intmain.io/tracker.js" data-ackee-server="https://ackee.intmain.io" data-ackee-domain-id="ae2b54a4-84be-4e13-9143-062488243a8c"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/base16/materia.min.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js"></script>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6442897272752686" crossorigin="anonymous"></script>
    <meta property="og:image" content="https://geraldo.dev/thumbnail/cpp.webp">
    <meta property="twitter:image" content="https://geraldo.dev/thumbnail/cpp.webp">
    <meta property="thumbnail" content="https://geraldo.dev/thumbnail/cpp.webp">
    <meta property="twitter:card" content="">
    <link rel="stylesheet" href="/styles.css">
  </head>
  <body class="bg-black">
    <nav class="bg-slate-800 text-blue-400 border-gray-200 px-2 sm:px-4 py-2.5">
      <div class="container flex flex-wrap justify-between items-center mx-auto"><a class="flex items-center" href="/"><img class="mr-3 h-6 sm:h-9" src="/logo.svg" alt="Geraldo Ribeiro"><span class="self-center text-xl font-semibold whitespace-nowrap underline-offset-8 hover:underline hover:text-white">Geraldo Ribeiro </span></a>
        <ul class="hidden fixed top-0 right-0 px-10 py-16 bg-gray-800 z-30 md:relative md:flex md:p-0 md:bg-transparent md:flex-row md:space-x-6" id="menu">
          <li class="z-40 fixed top-4 right-6 md:hidden" id="menu-close-btn"><a class="text-right text-blue-500 text-4xl font-bold" href="javascript:void(0)">&times;</a></li>
          <li><a class="block py-2 pr-4 pl-3 text-blue-400 underline-offset-8 hover:text-white hover:underline md:p-0" href="/about.html" aria-current="page">About</a></li>
          <li><a class="block py-2 pr-4 pl-3 text-blue-400 underline-offset-8 hover:text-white hover:underline md:p-0" href="/tils.html" aria-current="page">Today I Learned</a></li>
          <li><a class="block py-2 pr-4 pl-3 text-blue-400 underline-offset-8 hover:text-white hover:underline md:p-0" href="/certificates.html" aria-current="page">Certificates</a></li>
        </ul>
        <div class="flex mr-2 items-center md:hidden" id="menu-hamburger-btn"><a class="text-slate-500 text-2xl font-bold opacity-70 duration-300 hover:opacity-100" href="javascript:void(0)">&#x2630; </a></div>
      </div>
    </nav>
    <script>
      window.addEventListener("load", () => {
        const menuHamburgerBtn = document.querySelector("#menu-hamburger-btn");
        const menuCloseBtn = document.querySelector("#menu-close-btn");
        const menu = document.querySelector("#menu");
        menuHamburgerBtn.addEventListener("click", () => { menu.classList.toggle("hidden"); });
        menuCloseBtn.addEventListener("click", () => { menu.classList.toggle("hidden"); });
      });
    </script>
    <div class="prose mx-auto py-4 px-4">
      <form id="search" method="get" action="/search.html">
        <label class="mb-2 text-sm font-medium text-gray-300 sr-only" for="search-input">Search</label>
        <div class="relative">
          <div class="flex absolute inset-y-0 left-0 items-center pl-3 pointer-events-none">
            <svg class="w-5 h-5 text-gray-500 dark:text-gray-400" aria-hidden="true" fill="none" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
            </svg>
          </div>
          <input class="block p-4 pl-10 w-full text-sm text-white bg-slate-800 border border-slate-700 placeholder-slate-400 focus:ring-blue-500" id="search-input" type="search" name="query" placeholder="Search vim, bash..." required="">
          <button class="text-white absolute bg-slate-700 font-medium text-sm px-4 py-2 right-2.5 bottom-2.5 hover:bg-blue-800 focus:bg-blue-700 focus:outline-none focus:ring-blue-200" type="submit">Search</button>
        </div>
      </form>
    </div>
    <div class="bg-black text-slate-100 min-h-screen">
      <main class="bg-slate-900 max-w-prose mx-auto prose prose-invert text-slate-400 p-4 overflow-hidden"><a class="mb-2 text-slate-600 block cursor-pointer hover:text-slate-200" href="/tils.html">
          <svg class="inline h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M11 17l-5-5m0 0l5-5m-5 5h12"></path>
          </svg><span>Back to TILs</span></a>
        <h1>C++ GAlib</h1>
        <div class="text-slate-600">Date: <b class="mr-4 ml-2">2023-04-03</b>Last modified: <b class="ml-2">2023-04-05 </b></div>
        <div class="flex flex-wrap"><a class="tag no-underline" href="/til/tag/C++.html">C++</a><a class="tag no-underline" href="/til/tag/galib.html">galib</a>
        </div>
        <div class="mt-4 mx-auto"><img class="w-full my-0" src="/thumbnail/cpp.webp">
        </div><p><strong>Table of contents</strong></p>
<div class="table-of-contents"><ul><li><a href="#possible-output">Possible output</a></li><li><a href="#references">References</a></li></ul></div>
<pre><code class="language-cpp">#include &lt;fmt/core.h&gt;
#include &lt;ga/GARealGenome.h&gt;
#include &lt;ga/ga.h&gt;

#include &lt;cmath&gt;
#include &lt;fstream&gt;
#include &lt;ga/GARealGenome.C&gt;

FILE* genomeFile;

// Define the fitness function
float myObjective(GAGenome&amp; g) {
  GARealGenome genome = (GARealGenome&amp;)g;
  float x1 = genome.gene(0) - 33.0;
  float x2 = genome.gene(1) - 22.0;

  return (x1 * x1) + (x2 * x2);
  // The minimum value is (33;22)
}

int main([[maybe_unused]] int argc, [[maybe_unused]] char** argv) {
  constexpr auto minValue1 = -1.0;
  constexpr auto maxValue1 = 50.0;
  constexpr auto increment1 = 0.001;

  constexpr auto minValue2 = -2.0;
  constexpr auto maxValue2 = 40.0;
  constexpr auto increment2 = 0.005;

  genomeFile = fopen(&quot;output/galib_01.dat&quot;, &quot;w&quot;);

  GARandomSeed(123456);
  
  // One allele for each dimension
  GARealAlleleSetArray alleles;
  alleles.add(minValue1, maxValue1, increment1, GAAllele::EXCLUSIVE,
              GAAllele::EXCLUSIVE);
  alleles.add(minValue2, maxValue2, increment2, GAAllele::EXCLUSIVE,
              GAAllele::EXCLUSIVE);

  GARealGenome genome(alleles, myObjective);

  GASimpleGA ga(genome);
  ga.minimize();          // by default we want to minimize the objective
  ga.populationSize(10);  // how many individuals in the population
  ga.nGenerations(500);   // number of generations to evolve

  // Dumping data (optional)
  ga.scoreFrequency(20);  // keep the scores of every n generations
  ga.flushFrequency(20);  // specify how often to write the score to disk
  ga.scoreFilename(&quot;output/galib_01_score.txt&quot;);

  ga.initialize();
  // ----------------------------------------------------------------------
  // ga.evolve();
  // ----------------------------------------------------------------------
  // Or step by step
  size_t step{};
  while (!ga.done()) {
    ga.step();
    // Debugging
    if (step++ % 20 == 0) {
      GARealGenome&amp; best = (GARealGenome&amp;)ga.statistics().bestIndividual();
      fmt::print(genomeFile, &quot;{:3} {:.7f} {:.7f} {:.7f}\n&quot;, step, best.gene(0),
                 best.gene(1), best.score());
    }
  }
  // ----------------------------------------------------------------------

  // Print the best solution found
  GARealGenome&amp; best = (GARealGenome&amp;)ga.statistics().bestIndividual();
  fmt::print(&quot;Best X1: {:+.7f} X2: {:+.7f}\n&quot;, best.gene(0), best.gene(1));

  fmt::print(genomeFile, &quot;{:3} {:.7f} {:.7f} {:.7f}\n&quot;, step, best.gene(0),
             best.gene(1), best.score());
  fclose(genomeFile);

  // Plot
  FILE* gnuplotPipe = popen(&quot;gnuplot -persistent&quot;, &quot;w&quot;);
  fprintf(gnuplotPipe, &quot;set term svg enhanced size 1200 800\n&quot;);
  fprintf(gnuplotPipe, &quot;set output 'images/galib_01.svg'\n&quot;);
  fprintf(gnuplotPipe, &quot;set title 'Optimization progress' tc rgb 'white'\n&quot;);
  fprintf(gnuplotPipe, &quot;set xlabel 'Best of generation' tc rgb 'white'\n&quot;);
  fprintf(gnuplotPipe, &quot;set ylabel 'Input values and Score' tc rgb 'white'\n&quot;);
  fprintf(gnuplotPipe, &quot;set border lc rgb 'white'\n&quot;);
  fprintf(gnuplotPipe, &quot;set key tc rgb 'white'\n&quot;);
  fprintf(gnuplotPipe, &quot;set logscale y\n&quot;);
  fprintf(gnuplotPipe, &quot;set grid\n&quot;);
  fprintf(gnuplotPipe, &quot;set linetype 1 lc rgb 'orange' lw 2\n&quot;);
  fprintf(gnuplotPipe, &quot;set linetype 2 lc rgb 'cyan' lw 2\n&quot;);
  fprintf(gnuplotPipe, &quot;set linetype 3 lc rgb 'green' lw 2\n&quot;);
  fprintf(gnuplotPipe, &quot;set linetype 99 lc rgb 'white'\n&quot;);
  fprintf(gnuplotPipe, &quot;set xzeroaxis linetype 99\n&quot;);
  fprintf(gnuplotPipe, &quot;set yzeroaxis linetype 99\n&quot;);
  fprintf(gnuplotPipe,
          &quot;plot &quot;
          &quot;'output/galib_01.dat' using 1:4 w l title 'Score', &quot;
          &quot;'output/galib_01.dat' using 1:2 w l title 'X_1', &quot;
          &quot;'output/galib_01.dat' using 1:3 w l title 'X_2'\n&quot;);
  fflush(gnuplotPipe);
  pclose(gnuplotPipe);

  return 0;
}
</code></pre>
<figure>
  <img class="mx-auto" src="/til/cpp_galib_01.svg" alt="Plot">
  <figcaption class="text-center">
     <strong>Fig. 1</strong> - <span>Plot</span>
  </figcaption>
</figure>
<h2 id="possible-output" tabindex="-1">Possible output</h2>
<pre><code class="language-txt">Best X1: +32.7250023 X2: +22.2899990

</code></pre>
<p>Debugging evolution data:</p>
<pre><code class="language-txt">  1 30.8700008 17.3349991 26.2991295
 21 30.8700008 21.1099987 5.3289986
 41 30.8700008 21.1099987 5.3289986
 61 30.8700008 21.1099987 5.3289986
 81 30.8700008 21.1099987 5.3289986
101 30.8700008 21.1099987 5.3289986
121 30.8700008 21.1099987 5.3289986
141 34.7660027 21.1099987 3.9108677
161 34.7660027 21.1099987 3.9108677
181 34.7660027 21.1099987 3.9108677
201 34.7660027 21.1099987 3.9108677
221 34.7660027 21.1099987 3.9108677
241 34.7660027 21.1099987 3.9108677
261 32.7250023 22.2899990 0.1597232
281 32.7250023 22.2899990 0.1597232
301 32.7250023 22.2899990 0.1597232
321 32.7250023 22.2899990 0.1597232
341 32.7250023 22.2899990 0.1597232
361 32.7250023 22.2899990 0.1597232
381 32.7250023 22.2899990 0.1597232
401 32.7250023 22.2899990 0.1597232
421 32.7250023 22.2899990 0.1597232
441 32.7250023 22.2899990 0.1597232
461 32.7250023 22.2899990 0.1597232
481 32.7250023 22.2899990 0.1597232
500 32.7250023 22.2899990 0.1597232

</code></pre>
<p>Score file generated by <strong>galib</strong>.</p>
<pre><code class="language-txt">0	1223.13
20	271.691
40	554.674
60	75.4333
80	5.329
100	5.329
120	5.329
140	3.91087
160	3.91087
180	11.2698
200	97.5
220	723.864
240	3.91087
260	377.376
280	0.159723
300	384.785
320	572.807
340	0.159723
360	0.159723
380	0.159723
400	0.159723

</code></pre>
<h2 id="references" tabindex="-1">References</h2>
<ul>
<li><a href="link">title</a></li>
<li><a href="link">title</a></li>
<li><a href="link">title</a></li>
</ul>

      </main>
    </div>
    <footer class="bg-slate-500 text-slate-400 text-center pb-16">
      <div class="py-4 bg-slate-800">&copy; Geraldo Ribeiro 2024</div>
      <div class="max-w-prose mx-auto py-4 grid gap-y-8 grid-cols-3 justify-items-center md:grid-cols-5 lg:grid-cols-12"><a class="mx-2" href="mailto:geraldolsribeiro@gmail.com" target="_blank"><img class="h-12 w-12" title="E-mail" alt="E-mail" src="/social-email.svg"></a><a class="mx-2" href="https://www.linkedin.com/in/geraldolsribeiro/" target="_blank"><img class="h-12 w-12" title="Linkedin" alt="Linkedin" src="/social-linkedin.svg"></a><a class="mx-2" href="https://github.com/geraldolsribeiro" target="_blank"><img class="h-12 w-12" title="Github" alt="Github" src="/social-github.svg"></a><a class="mx-2" href="https://codepen.io/geraldolsribeiro/" target="_blank"><img class="h-12 w-12" title="Codepen" alt="Codepen" src="/social-codepen.svg"></a><a class="mx-2" href="https://twitter.com/geraldo_dev" target="_blank"><img class="h-12 w-12" title="Twitter" alt="Twitter" src="/social-twitter.svg"></a><a class="mx-2" href="https://t.me/geraldolsribeiro" target="_blank"><img class="h-12 w-12" title="Telegram" alt="Telegram" src="/social-telegram.svg"></a><a class="mx-2" href="https://api.whatsapp.com/send?phone=5512982302703&amp;text=Hi%20Geraldo!" target="_blank"><img class="h-12 w-12" title="Whatsapp" alt="Whatsapp" src="/social-whatsapp.svg"></a><a class="mx-2" href="https://www.instagram.com/geraldo.dev/" target="_blank"><img class="h-12 w-12" title="Instagram" alt="Instagram" src="/social-instagram.svg"></a><a class="mx-2" href="https://www.facebook.com/geraldolsribeiro" target="_blank"><img class="h-12 w-12" title="Facebook" alt="Facebook" src="/social-facebook.svg"></a><a class="mx-2" href="https://stackoverflow.com/users/554111/geraldo-luis-da-silva-ribeiro" target="_blank"><img class="h-12 w-12" title="StackOverflow" alt="StackOverflow" src="/social-stackoverflow.svg"></a><a class="mx-2" href="https://www.youtube.com/@dev.geraldo" target="_blank"><img class="h-12 w-12" title="Youtube" alt="Youtube" src="/social-youtube.svg"></a>
      </div>
    </footer>
    <script>
      //- hljs.highlightAll();
      //- https://github.com/wcoder/highlightjs-line-numbers.js
      //- Exemplo de numeracao em corba.md
      document.addEventListener('DOMContentLoaded', (event) => {
        document.querySelectorAll('pre code').forEach((el) => {
          hljs.highlightElement(el);
        });
      
        document.querySelectorAll('pre code[show-line-numbers]').forEach((el) => {
          hljs.lineNumbersBlock(el); // numbering using plugin
        });
      
      });
    </script>
    <script src="https://utteranc.es/client.js" repo="geraldolsribeiro/geraldo.dev" issue-term="pathname" theme="github-dark" crossorigin="anonymous" async></script>
  </body>
</html>