<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="Description not defined">
    <title>C++ Ranges 02</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/base16/materia.min.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js"></script>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6442897272752686" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="/styles.css">
  </head>
  <body class="bg-black">
    <nav class="bg-slate-800 text-blue-400 border-gray-200 px-2 sm:px-4 py-2.5">
      <div class="container flex flex-wrap justify-between items-center mx-auto"><a class="flex items-center" href="/"><img class="mr-3 h-6 sm:h-9" src="/logo.svg" alt="Geraldo Ribeiro"><span class="self-center text-xl font-semibold whitespace-nowrap underline-offset-8 hover:underline hover:text-white">Geraldo Ribeiro </span></a>
        <ul class="hidden fixed top-0 right-0 px-10 py-16 bg-gray-800 z-30 md:relative md:flex md:p-0 md:bg-transparent md:flex-row md:space-x-6" id="menu">
          <li class="z-40 fixed top-4 right-6 md:hidden" id="menu-close-btn"><a class="text-right text-blue-500 text-4xl font-bold" href="javascript:void(0)">&times;</a></li>
          <li><a class="block py-2 pr-4 pl-3 text-blue-400 underline-offset-8 hover:text-white hover:underline md:p-0" href="/about.html" aria-current="page">About</a></li>
          <li><a class="block py-2 pr-4 pl-3 text-blue-400 underline-offset-8 hover:text-white hover:underline md:p-0" href="/tils.html" aria-current="page">Today I Learned</a></li>
          <li><a class="block py-2 pr-4 pl-3 text-blue-400 underline-offset-8 hover:text-white hover:underline md:p-0" href="/certificates.html" aria-current="page">Certificates</a></li>
        </ul>
        <div class="flex mr-2 items-center md:hidden" id="menu-hamburger-btn"><a class="text-slate-500 text-2xl font-bold opacity-70 duration-300 hover:opacity-100" href="javascript:void(0)">&#x2630; </a></div>
      </div>
    </nav>
    <script>
      window.addEventListener("load", () => {
        const menuHamburgerBtn = document.querySelector("#menu-hamburger-btn");
        const menuCloseBtn = document.querySelector("#menu-close-btn");
        const menu = document.querySelector("#menu");
        menuHamburgerBtn.addEventListener("click", () => { menu.classList.toggle("hidden"); });
        menuCloseBtn.addEventListener("click", () => { menu.classList.toggle("hidden"); });
      });
    </script>
    <div class="prose mx-auto py-4 px-4">
      <form id="search" method="get" action="/search.html">
        <label class="mb-2 text-sm font-medium text-gray-300 sr-only" for="search-input">Search</label>
        <div class="relative">
          <div class="flex absolute inset-y-0 left-0 items-center pl-3 pointer-events-none">
            <svg class="w-5 h-5 text-gray-500 dark:text-gray-400" aria-hidden="true" fill="none" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
            </svg>
          </div>
          <input class="block p-4 pl-10 w-full text-sm text-white bg-slate-800 border border-slate-700 placeholder-slate-400 focus:ring-blue-500" id="search-input" type="search" name="query" placeholder="Search vim, bash..." required="">
          <button class="text-white absolute bg-slate-700 font-medium text-sm px-4 py-2 right-2.5 bottom-2.5 hover:bg-blue-800 focus:bg-blue-700 focus:outline-none focus:ring-blue-200" type="submit">Search</button>
        </div>
      </form>
    </div>
    <div class="bg-black text-slate-100 min-h-screen">
      <main class="bg-slate-900 max-w-prose mx-auto prose prose-invert text-slate-400 p-4 overflow-hidden"><a class="mb-2 text-slate-600 block cursor-pointer hover:text-slate-200" href="/tils.html">
          <svg class="inline h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M11 17l-5-5m0 0l5-5m-5 5h12"></path>
          </svg><span>Back to TILs</span></a>
        <h1>C++ Ranges 02</h1>
        <div class="flex flex-wrap"><a class="tag no-underline" href="/til/tag/C++.html">C++</a><a class="tag no-underline" href="/til/tag/ranges.html">ranges</a><a class="tag no-underline" href="/til/tag/views.html">views</a><a class="tag no-underline" href="/til/tag/views-reverse.html">views-reverse</a><a class="tag no-underline" href="/til/tag/views-drop.html">views-drop</a>
        </div><p>The input vector:</p>
<pre><code class="language-cpp">  std::vector vec{ 1, 2, 3, 4, 5, 6 };
</code></pre>
<p>A key feature of views is that whatever transformation they apply,
they do so at the moment you request an element, not when the
view is created.</p>
<pre><code class="language-cpp">  auto v1 = std::views::reverse( vec );
</code></pre>
<p>Here <code>v1</code> is a view; creating it neither changes vec, nor does
<code>v1</code> store any elements. The time it takes to construct <code>v1</code>
and its size in memory is independent of the size of <code>vec</code>.</p>
<pre><code class="language-cpp">  std::cout &lt;&lt; &quot;v1.begin = &quot; &lt;&lt; *v1.begin() &lt;&lt; '\n';
  std::cout &lt;&lt; &quot;vec.rbegin = &quot; &lt;&lt; *vec.rbegin() &lt;&lt; '\n';
</code></pre>
<p>This will print <code>6</code>, but the important thing is that resolving
the first element of v to the last element of vec happens
on-demand. This guarantees that views can be used as flexibly
as iterators, but it also means that if the view performs an
expensive transformation, it will have to do so repeatedly if
the same element is requested multiple times.</p>
<p>Changes on vector reflect on views</p>
<pre><code class="language-cpp">  vec[5] = 60;
  std::cout &lt;&lt; &quot;v1.begin = &quot; &lt;&lt; *v1.begin() &lt;&lt; '\n';
  std::cout &lt;&lt; &quot;vec.rbegin = &quot; &lt;&lt; *vec.rbegin() &lt;&lt; '\n';
</code></pre>
<p><code>std::views::reverse</code> is not the view itself, it’s an adaptor that
takes the underlying range (in our case the vector) and returns a
view object over the vector. The exact type of this view is hidden
behind the auto statement. This has the advantage, that we don’t
need to worry about the template arguments of the view type, but
more importantly the adaptor has an additional feature: it can be
chained with other adaptors!</p>
<pre><code class="language-cpp">  auto v2 = vec | std::views::reverse | std::views::drop( 2 );
  std::cout &lt;&lt; &quot;v2.begin() = &quot; &lt;&lt; *v2.begin() &lt;&lt; '\n';
</code></pre>
<p>It will print <code>4</code>, because <code>4</code> is the 0-th element of the reversed
string after dropping the first two.</p>
<div role="alert" class="my-4">
  <div class="bg-green-500 text-white font-bold rounded-t px-4 py-2">
    <span class="text-2xl">⚡</span>
    <span>Tip</span>
  </div>
  <div class="border border-t-0 border-green-400 rounded-b px-4 py-3">
  </div>
</div>
<pre><code class="language-cpp">  auto v3 = vec //
            | std::views::filter( []( auto const i ) { return i % 2 == 0; } )
            | std::views::transform( []( auto const i ) { return i * i; } );
  std::cout &lt;&lt; &quot;v3.begin() = &quot; &lt;&lt; *v3.begin() &lt;&lt; '\n'; // prints 4

  vec[1] = 16;                                         // 2 -&gt; 16
  std::cout &lt;&lt; &quot;v3.begin() = &quot; &lt;&lt; *v3.begin() &lt;&lt; '\n'; // prints 256
</code></pre>
<div role="alert" class="my-4">
  <div class="bg-yellow-200 text-black font-bold rounded-t px-4 py-2">
    <span class="text-2xl">☢</span>
    <span>Warning</span>
  </div>
  <div class="border border-t-0 border-yellow-200 rounded-b px-4 py-3">
  </div>
</div>
<pre><code class="language-cpp">  auto v4 = vec | std::views::reverse | std::views::drop( 2 );

  *v4.begin() = 42; // now vec == {1, 2, 3, 42, 5, 6 } !!
  std::cout &lt;&lt; &quot;vec[3] = &quot; &lt;&lt; vec[3] &lt;&lt; '\n';
</code></pre>
<h2 id="output" tabindex="-1">Output</h2>
<pre><code class="language-txt">v1.begin = 6
vec.rbegin = 6
v1.begin = 60
vec.rbegin = 60
v2.begin() = 4
v3.begin() = 4
v3.begin() = 256
vec[3] = 42

</code></pre>
<h2 id="references" tabindex="-1">References</h2>
<ul>
<li><a href="https://hannes.hauswedell.net/post/2019/11/30/range_intro/">A beginner’s guide to C++ Ranges and Views.</a></li>
<li><a href="https://itnext.io/c-20-ranges-complete-guide-4d26e3511db0">C++20 Ranges — Complete Guide</a></li>
</ul>

      </main>
    </div>
    <footer class="bg-slate-500 text-slate-400 text-center pb-16">
      <div class="py-4 bg-slate-800">&copy; Geraldo Ribeiro 2022</div>
      <div class="max-w-prose mx-auto py-4 grid gap-y-8 grid-cols-3 justify-items-center md:grid-cols-5 lg:grid-cols-10"><a class="mx-2" href="mailto:geraldolsribeiro@gmail.com" target="_blank"><img class="h-12 w-12" title="E-mail" alt="E-mail" src="/social-email.svg"></a><a class="mx-2" href="https://www.linkedin.com/in/geraldolsribeiro/" target="_blank"><img class="h-12 w-12" title="Linkedin" alt="Linkedin" src="/social-linkedin.svg"></a><a class="mx-2" href="https://github.com/geraldolsribeiro" target="_blank"><img class="h-12 w-12" title="Github" alt="Github" src="/social-github.svg"></a><a class="mx-2" href="https://codepen.io/geraldolsribeiro/" target="_blank"><img class="h-12 w-12" title="Codepen" alt="Codepen" src="/social-codepen.svg"></a><a class="mx-2" href="https://twitter.com/geraldo_dev" target="_blank"><img class="h-12 w-12" title="Twitter" alt="Twitter" src="/social-twitter.svg"></a><a class="mx-2" href="https://t.me/geraldolsribeiro" target="_blank"><img class="h-12 w-12" title="Telegram" alt="Telegram" src="/social-telegram.svg"></a><a class="mx-2" href="https://api.whatsapp.com/send?phone=5512982302703&amp;text=Hi%20Geraldo!" target="_blank"><img class="h-12 w-12" title="Whatsapp" alt="Whatsapp" src="/social-whatsapp.svg"></a><a class="mx-2" href="https://www.instagram.com/geraldo.dev/" target="_blank"><img class="h-12 w-12" title="Instagram" alt="Instagram" src="/social-instagram.svg"></a><a class="mx-2" href="https://www.facebook.com/geraldolsribeiro" target="_blank"><img class="h-12 w-12" title="Facebook" alt="Facebook" src="/social-facebook.svg"></a><a class="mx-2" href="https://stackoverflow.com/users/554111/geraldo-luis-da-silva-ribeiro" target="_blank"><img class="h-12 w-12" title="StackOverflow" alt="StackOverflow" src="/social-stackoverflow.svg"></a>
      </div>
    </footer>
    <script>
      //- hljs.highlightAll();
      //- https://github.com/wcoder/highlightjs-line-numbers.js
      //- Exemplo de numeracao em corba.md
      document.addEventListener('DOMContentLoaded', (event) => {
        document.querySelectorAll('pre code').forEach((el) => {
          hljs.highlightElement(el);
        });
      
        document.querySelectorAll('pre code[show-line-numbers]').forEach((el) => {
          hljs.lineNumbersBlock(el); // numbering using plugin
        });
      
      });
    </script>
    <script src="https://utteranc.es/client.js" repo="geraldolsribeiro/geraldo.dev" issue-term="pathname" theme="github-dark" crossorigin="anonymous" async></script>
  </body>
</html>